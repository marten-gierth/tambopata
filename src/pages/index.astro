---
import Clock from '../components/Clock.jsx';
import WorldGlobe from '../components/WorldGlobe.jsx';
import {getSharedWeatherData} from '../services/weatherService.js'; // Call the service to ensure data is fetched (or retrieved from cache)
await getSharedWeatherData();
---

<html lang="en">
<head>
    <meta charset="utf-8"/>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg"/>
    <meta name="viewport" content="width=device-width"/>
    <meta name="generator" content={Astro.generator}/>
    <title>Tambopata & Dresden</title>
</head>
<style>
    html, body {
        overflow-x: hidden;
    }

    body {
        background: black;
        color: white;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }

    h1 {
        font-size: clamp(1.55rem, 5vw, 3rem);
        margin: 0;
        padding: 1rem 0 0 0;
    }

    a {
        color: white;
        text-decoration: underline;
    }

    main {
        position: relative;
        margin: 0;
        padding: 0;
    }

    .content {
        position: relative;
        z-index: 1;
        padding: 2rem;
    }

    @media (max-width: 960px) {
        .content {
            padding: 0.5rem;
        }
    }

    .background-globe {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: -1;
        pointer-events: auto;
    }

    footer {
        position: absolute;
        bottom: 4px;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        font-size: 0.7rem;
        display: flex;
        align-items: center;
        white-space: nowrap;
        line-height: 1.5;
    }
</style>
<body>
<main>
    <div class="background-globe">
        <WorldGlobe client:only/>
    </div>
    <div class="content">
        <h1>üå≥ Tambopata & <span style="white-space: nowrap;">üè† Dresden</span>
        </h1>
        <Clock client:load/>
    </div>
</main>
<footer>
    <p>
        Made for Fanny :) | <a href="https://martengierth.de/legal/" target="_blank" rel="noopener noreferrer">Legal
        Notice</a><br/>
        ‚õÖ Weather from <a href="https://github.com/open-meteo/open-meteo" target="_blank" rel="noopener noreferrer">Open-Meteo</a>
        is
        {/* The <a> tag now correctly wraps the <img> tag, making it clickable */}
        <a
                href="https://tambopata-dresden.openstatus.dev"
                target="_blank"
                rel="noopener noreferrer">
            <img
                    src="https://tambopata-dresden.openstatus.dev/badge?theme=light&size=sm"
                    alt="Website Status"
                    style={{
                        height: '20px',
                        verticalAlign: 'middle'
                    }}
            />
        </a>
        <br/>
        üåé Visualization with <a href="https://github.com/vasturiano/three-globe" target="_blank"
                                rel="noopener noreferrer">three-globe</a>
    </p>
</footer>
</body>
</html>
